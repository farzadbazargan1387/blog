<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header"></head>
<body>
<header class="ns-header ns-animate-up">
    <div class="ns-container">
        <a href="/" class="brand-link brand">
            <div class="brand-logo">NS</div>
            <div>
                <div class="brand-title">Nocturne Soul</div>
                <div class="brand-sub">Voice of the night</div>
            </div>
        </a>

    </div>
</header>

<main class="ns-container">
    <!-- Index posts grid -->
    <section th:if="${posts != null}" class="posts-grid ns-animate-up">
        <div th:each="p : ${posts.content}">
            <article class="card">
                <a th:href="@{/posts/{slug}(slug=${p.slug})}" class="card-link">
                    <h2 th:text="${p.title}" class="card-title">Post Title</h2>
                    <p th:text="${p.excerpt}" class="card-excerpt">Post excerpt</p>
                </a>
                <div class="card-meta">
                    <span th:text="${post.author != null ? p.author.fullName : 'Unknown'}">Author</span> ·
                    <p th:text="${#temporals.format(post.createdAt, 'dd/MM/yyyy HH:mm')}"></p>




                </div>
            </article>
        </div>
        <div th:if="${#lists.isEmpty(posts.content)}">
            <p>No posts available.</p>
        </div>
    </section>

    <!-- Single post detail -->
    <article th:if="${post != null}" class="post post_detail ns-animate-up">
        <header class="post-header">
            <h1 th:text="${post.title}" class="post-title">Title</h1>
            <div class="post-meta">
                <span th:text="${post.author != null ? post.author.fullName : 'Unknown'}">Author</span>
                · <p th:text="${#temporals.format(post.createdAt, 'dd/MM/yyyy HH:mm')}"></p>

            </div>
        </header>

        <section class="post-content" th:utext="${post.content}">
            <!-- post HTML content -->
        </section>

        <section class="comments ns-animate-up">
            <h3>Comments</h3>
            <div th:each="c : ${comments}" class="comment">
                <div class="comment-meta">
                    <td th:text="${c.user != null ? c.user.username : 'Unknown'}"></td>

                    • <time th:text="${post.publishedAt != null ? #temporals.format(post.publishedAt,'dd MMM yyyy') : ''}">date</time>

                </div>
                <p th:text="${c.content}">Comment text</p>
            </div>

            <form th:action="@{/comments/{slug}/comments(slug=${post.slug})}" method="post" class="comment-form">
                <textarea name="content" placeholder="Write your comment..." required></textarea>
                <button class="btn primary" type="submit">Submit comment</button>
            </form>

            <div th:each="comment : ${comments}">
                <p>
                    <strong th:text="${comment.user != null ? comment.user.username : 'Anonymous'}">Username</strong>

                    <span th:text="${comment.content}">Comment</span>
                    <small th:text="${#temporals.format(comment.createdAt,'dd/MM/yyyy HH:mm')}">Date</small>
                </p>
            </div>


        </section>
    </article>

    <!-- Sidebar -->
    <aside class="sidebar ns-animate-left">
        <div class="widget">
            <h3>Categories</h3>
            <ul>
                <li th:each="c : ${categories}" th:if="${c != null}">
                    <a th:href="@{|/categories/${c.slug}|}" th:text="${c.name}">Category</a>
                </li>
            </ul>
        </div>

        <div class="widget">
            <h3>Tags</h3>
            <div class="tag-cloud">
                <a th:each="t : ${tags}" th:if="${t != null}" th:href="@{|/tags/${t.slug}|}" th:text="${t.name}" class="tag">Tag</a>
            </div>
        </div>
    </aside>
</main>

<div th:replace="fragments/footer :: footer"></div>
<script th:src="@{/js/nocturne.js}"></script>
</body>
</html>
